'use client';

import { useRef } from 'react';
import gsap from 'gsap';
import { useGSAP } from '@gsap/react';
import { openWhatsApp } from '@/utils/whatsapp';

export default function WhatsAppButton() {
    const buttonRef = useRef<HTMLButtonElement>(null);
    const labelRef = useRef<HTMLSpanElement>(null);

    useGSAP(() => {
        const tl = gsap.timeline({ delay: 2 });

        tl.fromTo(buttonRef.current,
            { scale: 0, opacity: 0 },
            { scale: 1, opacity: 1, duration: 0.5, ease: "back.out(1.7)" }
        );

        tl.fromTo(labelRef.current,
            { x: 20, opacity: 0 },
            { x: 0, opacity: 1, duration: 0.5, ease: "power2.out" },
            "-=0.3"
        );
    }, { scope: buttonRef });

    return (
        <div className="fixed bottom-8 right-8 z-[90] flex items-center gap-4">
            <span
                ref={labelRef}
                className="hidden md:block bg-white text-espresso px-4 py-2 rounded-full shadow-lg font-medium text-sm pointer-events-none opacity-0"
            >
                Order on WhatsApp
            </span>
            <button
                ref={buttonRef}
                onClick={() => openWhatsApp()}
                className="w-16 h-16 bg-[#25D366] rounded-full shadow-xl flex items-center justify-center hover:scale-110 transition-transform duration-300 group opacity-0"
                aria-label="Chat on WhatsApp"
            >
                <svg
                    width="32"
                    height="32"
                    viewBox="0 0 24 24"
                    fill="white"
                    xmlns="http://www.w3.org/2000/svg"
                    className="group-hover:rotate-12 transition-transform duration-300"
                >
                    <path d="M17.472 14.382C17.112 14.382 16.752 14.382 16.392 14.382C16.392 14.382 16.392 14.382 16.392 14.382C16.032 14.382 15.672 14.382 15.312 14.382C15.132 14.382 14.952 14.382 14.772 14.382C14.772 14.382 14.772 14.382 14.772 14.382C14.412 14.382 14.052 14.382 13.692 14.382C13.512 14.382 13.332 14.382 13.152 14.382C13.152 14.382 13.152 14.382 13.152 14.382C12.792 14.382 12.432 14.382 12.072 14.382C11.892 14.382 11.712 14.382 11.532 14.382C11.532 14.382 11.532 14.382 11.532 14.382C11.172 14.382 10.812 14.382 10.452 14.382C10.272 14.382 10.092 14.382 9.912 14.382C9.912 14.382 9.912 14.382 9.912 14.382C9.552 14.382 9.192 14.382 8.832 14.382C8.652 14.382 8.472 14.382 8.292 14.382C8.292 14.382 8.292 14.382 8.292 14.382C7.932 14.382 7.572 14.382 7.212 14.382C7.032 14.382 6.852 14.382 6.672 14.382C6.672 14.382 6.672 14.382 6.672 14.382C6.312 14.382 5.952 14.382 5.592 14.382C5.412 14.382 5.232 14.382 5.052 14.382C5.052 14.382 5.052 14.382 5.052 14.382C4.692 14.382 4.332 14.382 3.972 14.382C3.792 14.382 3.612 14.382 3.432 14.382C3.432 14.382 3.432 14.382 3.432 14.382C3.072 14.382 2.712 14.382 2.352 14.382C2.172 14.382 1.992 14.382 1.812 14.382C1.812 14.382 1.812 14.382 1.812 14.382C1.452 14.382 1.092 14.382 0.732 14.382C0.552 14.382 0.372 14.382 0.192 14.382L0 14.382L0.66 16.8L1.32 19.218L3.792 18.57L6.264 17.922L6.192 17.658C6.12 17.394 6.048 17.262 6.18 17.262C6.312 17.262 6.648 17.262 6.984 17.262C7.32 17.262 7.656 17.262 7.656 17.262C7.656 17.262 7.992 17.262 8.328 17.262C8.664 17.262 9.000 17.262 9.000 17.262C9.336 17.262 9.672 17.262 10.008 17.262C10.344 17.262 10.344 17.262 10.344 17.262C10.680 17.262 11.016 17.262 11.352 17.262C11.688 17.262 11.688 17.262 11.688 17.262C12.024 17.262 12.360 17.262 12.696 17.262C13.032 17.262 13.032 17.262 13.032 17.262C13.368 17.262 13.704 17.262 14.040 17.262C14.376 17.262 14.376 17.262 14.376 17.262C14.712 17.262 15.048 17.262 15.384 17.262C15.720 17.262 15.720 17.262 15.720 17.262C16.056 17.262 16.392 17.262 16.728 17.262C17.064 17.262 17.064 17.262 17.064 17.262C17.400 17.262 17.736 17.262 18.072 17.262C18.408 17.262 18.408 17.262 18.408 17.262C18.744 17.262 19.080 17.262 19.416 17.262C19.752 17.262 19.752 17.262 19.752 17.262C20.088 17.262 20.424 17.262 20.760 17.262C21.096 17.262 21.096 17.262 21.096 17.262C21.432 17.262 21.768 17.262 22.104 17.262C22.440 17.262 22.440 17.262 22.440 17.262C22.776 17.262 23.112 17.262 23.448 17.262C23.784 17.262 23.784 17.262 23.784 17.262C23.784 16.926 23.784 16.590 23.784 16.254C23.784 15.918 23.784 15.918 23.784 15.918C23.784 15.582 23.784 15.246 23.784 14.910C23.784 14.574 23.784 14.574 23.784 14.574C23.784 14.238 23.784 13.902 23.784 13.566C23.784 13.230 23.784 13.230 23.784 13.230C23.784 12.894 23.784 12.558 23.784 12.222C23.784 11.886 23.784 11.886 23.784 11.886C23.784 11.550 23.784 11.214 23.784 10.878C23.784 10.542 23.784 10.542 23.784 10.542C23.784 10.206 23.784 9.870 23.784 9.534C23.784 9.198 23.784 9.198 23.784 9.198C23.784 8.862 23.784 8.526 23.784 8.190C23.784 7.854 23.784 7.854 23.784 7.854C23.784 7.518 23.784 7.182 23.784 6.846C23.784 6.510 23.784 6.510 23.784 6.510C23.784 6.174 23.784 5.838 23.784 5.502C23.784 5.166 23.784 5.166 23.784 5.166C23.784 4.830 23.784 4.494 23.784 4.158C23.784 3.822 23.784 3.822 23.784 3.822C23.784 3.486 23.784 3.150 23.784 2.814C23.784 2.478 23.784 2.478 23.784 2.478C23.784 2.142 23.784 1.806 23.784 1.470C23.784 1.134 23.784 0.798 23.784 0.462C23.784 0.126 23.658 0.000 23.322 0.000C22.986 0.000 22.650 0.000 22.314 0.000C21.978 0.000 21.978 0.000 21.978 0.000C21.642 0.000 21.306 0.000 20.970 0.000C20.634 0.000 20.634 0.000 20.634 0.000C20.298 0.000 19.962 0.000 19.626 0.000C19.290 0.000 19.290 0.000 19.290 0.000C18.954 0.000 18.618 0.000 18.282 0.000C17.946 0.000 17.946 0.000 17.946 0.000C17.610 0.000 17.274 0.000 16.938 0.000C16.602 0.000 16.602 0.000 16.602 0.000C16.266 0.000 15.930 0.000 15.594 0.000C15.258 0.000 15.258 0.000 15.258 0.000C14.922 0.000 14.586 0.000 14.250 0.000C13.914 0.000 13.914 0.000 13.914 0.000C13.578 0.000 13.242 0.000 12.906 0.000C12.570 0.000 12.570 0.000 12.570 0.000C12.234 0.000 11.898 0.000 11.562 0.000C11.226 0.000 11.226 0.000 11.226 0.000C10.890 0.000 10.554 0.000 10.218 0.000C9.882 0.000 9.882 0.000 9.882 0.000C9.546 0.000 9.210 0.000 8.874 0.000C8.538 0.000 8.538 0.000 8.538 0.000C8.202 0.000 7.866 0.000 7.530 0.000C7.194 0.000 7.194 0.000 7.194 0.000C6.858 0.000 6.522 0.000 6.186 0.000C5.850 0.000 5.850 0.000 5.850 0.000C5.514 0.000 5.178 0.000 4.842 0.000C4.506 0.000 4.506 0.000 4.506 0.000C4.170 0.000 3.834 0.000 3.498 0.000C3.162 0.000 3.162 0.000 3.162 0.000C2.826 0.000 2.490 0.000 2.154 0.000C1.818 0.000 1.818 0.000 1.818 0.000C1.482 0.000 1.146 0.000 0.810 0.000C-0.372 0.000 -0.054 0.612 0.702 1.458C1.458 2.304 3.018 3.966 3.018 3.966C3.018 3.966 4.398 5.430 4.398 5.430C4.398 5.430 5.778 6.894 5.778 6.894C5.778 6.894 8.538 8.862 8.538 8.862C8.538 8.862 11.298 10.830 11.298 10.830C11.298 10.830 14.130 12.606 14.130 12.606C14.130 12.606 16.962 14.382 16.962 14.382C16.962 14.382 17.298 14.382 17.658 14.382C18.018 14.382 18.018 14.382 18.018 14.382C18.378 14.382 18.738 14.382 19.098 14.382C19.458 14.382 19.458 14.382 19.458 14.382C19.818 14.382 20.178 14.382 20.538 14.382C20.898 14.382 20.898 14.382 20.898 14.382C21.258 14.382 21.618 14.382 21.978 14.382C22.338 14.382 22.338 14.382 22.338 14.382C22.698 14.382 23.058 14.382 23.418 14.382C23.598 14.382 23.778 14.382 23.958 14.382" stroke="white" strokeWidth="0.1" />
                    <path d="M12.0117 2C6.48892 2 2.01172 6.47715 2.01172 12C2.01172 13.9142 2.54879 15.7003 3.48888 17.2343L2.01172 22.0117L6.96492 20.5976C8.44109 21.4886 10.1718 22 12.0117 22C17.5345 22 22.0117 17.5228 22.0117 12C22.0117 6.47715 17.5345 2 12.0117 2ZM17.3736 15.6587C17.1528 16.2798 16.0963 16.8202 15.6174 16.8687C15.2289 16.9076 14.7171 16.9589 12.9806 16.2415C10.7495 15.3197 9.31428 13.0487 9.20405 12.9008C9.09382 12.753 8.30396 11.6986 8.30396 10.6083C8.30396 9.51804 8.85532 8.98592 9.07478 8.76518C9.25595 8.58498 9.45662 8.54228 9.61719 8.54228C9.77775 8.54228 9.93832 8.54636 10.0989 8.55392C10.2192 8.55958 10.2794 8.57218 10.3597 8.76518C10.4601 9.00628 10.9616 10.2307 11.0218 10.3512C11.082 10.4717 11.1422 10.6323 11.062 10.7928C10.9818 10.9534 10.9015 11.0537 10.7812 11.1943C10.6608 11.3349 10.5304 11.3349 10.41 11.4554C10.2997 11.5658 10.1793 11.6963 10.3299 11.9575C10.4804 12.2188 11.0018 13.072 11.7644 13.7508C12.7479 14.6258 13.5407 14.9069 13.8217 15.0274C14.1027 15.1479 14.2633 15.1278 14.4238 14.9472C14.5843 14.7665 15.1362 14.1239 15.3168 13.8629C15.4975 13.6019 15.6781 13.6421 15.9189 13.7324C16.1598 13.8228 17.4439 14.4554 17.7048 14.5859C17.9657 14.7164 18.1463 14.7766 18.2065 14.8871C18.2667 14.9975 18.2667 15.3991 18.0661 15.6587H17.3736Z" fill="white" />
                </svg>
            </button>
        </div>
    );
}
